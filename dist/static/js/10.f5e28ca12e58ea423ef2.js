webpackJsonp([10],{"71X+":function(t,e){},HjbY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mvHQ"),a=i.n(n),l={data:function(){return{preParentId:1,ParentId:1,inquireParent:!1,table:[],sels:[],dialogVisible:!1,rightsTree:{data:[],checked:[],defaultProps:{children:"children",label:"label"}},roleId:""}},activated:function(){this.initialization()},methods:{initialization:function(){this.getRole(this.ParentId)},inquireChildNode:function(t){this.preParentId=this.ParentId,this.ParentId=t.Id,this.initialization(),1==this.ParentId?this.inquireParent=!1:this.inquireParent=!0,console.log(this.ParentId),console.log(this.preParentId)},inquireParentNode:function(){this.ParentId=this.preParentId,this.preParentId=this.initialization(),1==this.ParentId?this.inquireParent=!1:this.inquireParent=!0,console.log(this.ParentId),console.log(this.id)},getRole:function(t){var e=this;this.$http.get("/api/Role/GetRoleView",{params:{roleId:this.ParentId}}).then(function(t){console.log(t.data.Child),e.table=t.data.Child,e.preParentId=t.data.ParentId})},stateFormat:function(t,e){return 1==t[e.property]?"有效":"无效"},selsChange:function(t){this.sels=t},add:function(){this.$router.push({path:"/addrole",query:{ParentId:this.ParentId}})},edit:function(t){this.$router.push({path:"/editrole",query:{model:t}})},deletemodel:function(){var t=this,e="";this.sels.forEach(function(t){e=e+t.Id+"|"}),e=e.substring(0,e.length-1),console.log(e),this.$http.get("/api/Role/DeleteRole",{params:{id:e}}).then(function(e){t.getRole()})},showAddRight:function(t,e){var i=this;this.dialogVisible=!0,this.roleId=e.Id,console.log(e.Id),this.rightsTree.checked=e.RightsId,this.$http.get("/api/Role/GetRightsTreeView",{params:{id:0}}).then(function(t){i.rightsTree.data=JSON.parse(a()(t.data[0].children)),console.log(i.rightsTree.data)})},addRiht:function(){var t=this,e=this.$refs.tree.getCheckedKeys(),i="";this.$refs.tree.getCheckedKeys().forEach(function(t){i=i+"|"+t}),i=i.substring(1,i.length),console.log(e),console.log(this.roleId),this.$http.get("/api/Role/RelationRigths",{params:{roleId:this.roleId,rightid:i}}).then(function(e){t.dialogVisible=!1,t.initialization()})}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[t.inquireParent?i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-back"},on:{click:function(e){t.inquireParentNode()}}},[t._v("返回上一级")]):t._e(),t._v(" "),i("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"delete"},on:{click:t.deletemodel}},[t._v(" 批量删除")]),t._v(" "),i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:t.add}},[t._v(" 添加权限 ")])],1),t._v(" "),i("el-table",{ref:"list",attrs:{data:t.table},on:{"selection-change":t.selsChange}},[i("el-table-column",{attrs:{type:"selection"}}),t._v(" "),i("el-table-column",{attrs:{prop:"Name",label:"名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"IsValid",label:"状态",formatter:t.stateFormat}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small"},on:{click:function(i){t.edit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){t.showAddRight(e.$index,e.row)}}},[t._v("功能")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:function(i){t.inquireChildNode(e.row)}}},[t._v("子角色")])]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:"配置角色功能",visible:t.dialogVisible,size:"tiny"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"select-tree"},[i("el-scrollbar",{staticClass:"is-empty",attrs:{id:"teer",tag:"div"}},[i("el-tree",{ref:"tree",attrs:{data:t.rightsTree.data,props:t.rightsTree.defaultProps,"show-checkbox":"","default-expand-all":"","node-key":"value","default-checked-keys":t.rightsTree.checked}})],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.addRiht}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var r=i("VU/8")(l,s,!1,function(t){i("71X+")},null,null);e.default=r.exports}});