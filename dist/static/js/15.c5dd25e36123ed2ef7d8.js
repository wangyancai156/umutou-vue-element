webpackJsonp([15],{SKya:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){return{Pagesize:10,PageIndex:1,TotalCount:0,table:[],Status:{val:"PO-010",data:[{Id:"PO-010",text:"待提交"},{Id:"PO-020",text:"待审批"},{Id:"PO-030",text:"待到货"}]}}},activated:function(){this.initialization()},methods:{initialization:function(){this.getPurchaseOrderView()},handleSizeChange:function(e){this.Pagesize=e,this.getPurchaseOrderView()},handleCurrentChange:function(e){this.PageIndex=e,this.getPurchaseOrderView()},getPurchaseOrderView:function(){var e=this,t=window.localStorage.getItem("ms_username");this.$http.get("/api/PurchaseOrder/getPurchaseOrderViewByStatus",{params:{PageIndex:this.PageIndex,PageSize:this.Pagesize,StatuId:this.Status.val,OperatorId:t}}).then(function(t){var a=t.data,r=a.EntityList,s=a.TotalCount,n=a.PageIndex;console.log(r),e.table=r,e.TotalCount=s,e.PageIndex=n})},selsChange:function(e){this.sels=e},addPurchaseOrder:function(){this.$router.push("addpurchaseorder")},removePurchaseOrder:function(){var e=this,t="";this.sels.forEach(function(e){t=t+"|"+e.Id}),this.$http.get("/api/PurchaseOrder/RemovePurchaseOrder",{params:{id:t}}).then(function(t){e.getPurchaseOrderView()})},addPurchaseOrderDetail:function(e){this.$router.push({path:"/addpurchaseorderdetail",query:{model:e}})},purchaseApply:function(e){var t=this;this.$http.get("/api/PurchaseOrder/PurchaseApply",{params:{id:e.Id,operatorId:"W001"}}).then(function(e){console.log(e.data),1==e.data?(alert("已提交！"),t.getPurchaseOrderView()):alert("提交失败！")})},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":a.substring(0,10)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"delete"},on:{click:function(t){e.removePurchaseOrder()}}},[e._v(" 批量删除")]),e._v(" "),a("el-select",{staticClass:"handle-select mr10",attrs:{filterable:"",placeholder:"选择状态"},model:{value:e.Status.val,callback:function(t){e.$set(e.Status,"val",t)},expression:"Status.val"}},e._l(e.Status.data,function(e){return a("el-option",{key:e.Id,attrs:{label:e.text,value:e.Id}})})),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.getPurchaseOrderView}},[e._v("搜索")]),e._v(" "),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:e.addPurchaseOrder}},[e._v("添加采购单")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.table},on:{"selection-change":e.selsChange}},[a("el-table-column",{staticStyle:{width:"5%"},attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"30%"},attrs:{prop:"Id",label:"采购编号"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"15%"},attrs:{prop:"PurchaseType.Description",label:"采购类型"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"30%"},attrs:{prop:"Supplier.Name",label:"供应商"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"PaymentType.Name",label:"付款方案"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"CreateUser.UserName",label:"申请人"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"CreateDate",label:"操作时间"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"}},[a("span",{on:{click:function(a){e.addPurchaseOrderDetail(t.row)}}},[e._v(" 明细 ")]),e._v(" "),a("span",{on:{click:function(a){e.purchaseApply(t.row)}}},[e._v(" 提交 ")])])]}}])})],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.PageIndex,"page-sizes":[5,10,20,100],"page-size":e.Pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.TotalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var n=a("VU/8")(r,s,!1,function(e){a("v8aY")},null,null);t.default=n.exports},v8aY:function(e,t){}});