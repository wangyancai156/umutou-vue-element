webpackJsonp([14],{Rua7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),l=a.n(i),n={data:function(){return{table:[],sels:[],search:{name:"",org:"",organization:[]},dialogVisible:!1,roleTree:{data:[],checked:[],defaultProps:{children:"children",label:"label"}},userId:""}},activated:function(){this.initialization()},methods:{initialization:function(){this.getOrganization(),this.getUserPage()},onOrganizationChang:function(e){console.log(e);var t=e[e.length-1];this.search.org=t,this.getUserPage()},getUserPage:function(){var e=this;this.$http.get("/api/Users/GetUsers",{params:{OrganizationId:this.search.org,Name:this.search.name}}).then(function(t){e.table=t.data,console.log(t.data)})},getOrganization:function(){var e=this;this.$http.get("/api/Organization/GetOrganizationTree",{}).then(function(t){e.search.organization=t.data[0].children})},stateFormat:function(e,t){return 1==e[t.property]?"有效":"无效"},selsChange:function(e){this.sels=e},add:function(){this.$router.push({path:"/adduser"})},edit:function(e){this.$router.push({path:"/editruser",query:{model:e}})},deleteuser:function(){var e=this,t="";this.sels.forEach(function(e){t=t+"|"+e.Id}),console.log(t),this.$http.get("/api/Users/DeleteUsers",{params:{id:t}}).then(function(t){e.initialization()})},showAddRole:function(e,t){var a=this;this.dialogVisible=!0,this.userId=t.Id,console.log(t.Id),this.roleTree.checked=t.RoleId,this.$http.get("/api/Role/GetRoleTreeView",{params:{roleId:1}}).then(function(e){a.roleTree.data=JSON.parse(l()(e.data[0].children)),console.log(a.roleTree.data)})},addRole:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),a="";this.$refs.tree.getCheckedKeys().forEach(function(e){a=a+"|"+e}),a=a.substring(1,a.length),console.log(t),console.log(this.RoleId),this.$http.get("/api/Users/RelationRole",{params:{userId:this.userId,roleId:a}}).then(function(t){e.dialogVisible=!1,e.initialization()})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"delete"},on:{click:function(t){e.deleteuser()}}},[e._v(" 批量删除")]),e._v(" "),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:e.add}},[e._v("添加员工")]),e._v(" "),a("el-cascader",{attrs:{options:e.search.organization},on:{change:e.onOrganizationChang}}),e._v(" "),a("el-input",{staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"姓名"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.getUserPage}},[e._v("搜索")])],1),e._v(" "),a("el-table",{ref:"list",staticStyle:{width:"100%"},attrs:{data:e.table},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Id",label:"员工号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"UserName",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Telephone",label:"电话"}}),e._v(" "),a("el-table-column",{attrs:{prop:"SignState",label:"状态",formatter:e.stateFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.showAddRole(t.$index,t.row)}}},[e._v("添加权限")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"配置用户角色",visible:e.dialogVisible,size:"tiny"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"select-tree"},[a("el-scrollbar",{staticClass:"is-empty",attrs:{id:"teer",tag:"div"}},[a("el-tree",{ref:"tree",attrs:{data:e.roleTree.data,props:e.roleTree.defaultProps,"show-checkbox":"","default-expand-all":"","node-key":"value","default-checked-keys":e.roleTree.checked}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(n,s,!1,function(e){a("lNdl")},null,null);t.default=o.exports},lNdl:function(e,t){}});