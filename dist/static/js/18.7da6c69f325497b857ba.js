webpackJsonp([18],{SKya:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){return{Pagesize:10,PageIndex:1,TotalCount:0,table:[],Status:{val:"PO-010",data:[{Id:"PO-010",text:"待提交"},{Id:"PO-020",text:"待审批"},{Id:"PO-030",text:"待到货"}]}}},activated:function(){this.initialization()},methods:{initialization:function(){this.getPurchaseOrderView()},handleSizeChange:function(t){this.Pagesize=t,this.getPurchaseOrderView()},handleCurrentChange:function(t){this.PageIndex=t,this.getPurchaseOrderView()},getPurchaseOrderView:function(){var t=this,e=window.localStorage.getItem("ms_username");this.$http.get("/api/PurchaseOrder/getPurchaseOrderViewByStatus",{params:{PageIndex:this.PageIndex,PageSize:this.Pagesize,StatuId:this.Status.val,OperatorId:e}}).then(function(e){var a=e.data,r=a.EntityList,n=a.TotalCount,l=a.PageIndex;console.log(r),t.table=r,t.TotalCount=n,t.PageIndex=l})},selsChange:function(t){this.sels=t},addPurchaseOrder:function(){this.$router.push("addpurchaseorder")},removePurchaseOrder:function(){var t=this,e="";this.sels.forEach(function(t){e=e+"|"+t.Id}),this.$http.get("/api/PurchaseOrder/RemovePurchaseOrder",{params:{id:e}}).then(function(e){t.getPurchaseOrderView()})},addPurchaseOrderDetail:function(t){this.$router.push({path:"/addpurchaseorderdetail",query:{model:t}})},purchaseApply:function(t){var e=this;this.$http.get("/api/PurchaseOrder/PurchaseApply",{params:{id:t.Id,operatorId:"W001"}}).then(function(t){console.log(t.data),1==t.data?(alert("已提交！"),e.getPurchaseOrderView()):alert("提交失败！")})},dateFormat:function(t){function e(e,a){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var a=t[e.property];if(console.log(a),void 0==a)return"";var r=JSON.parse(a);return console.log(r),dateFormat(a)})}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger",icon:"delete"},on:{click:function(e){t.removePurchaseOrder()}}},[t._v(" 批量删除")]),t._v(" "),a("el-select",{staticClass:"handle-select mr10",attrs:{filterable:"",placeholder:"选择状态"},model:{value:t.Status.val,callback:function(e){t.$set(t.Status,"val",e)},expression:"Status.val"}},t._l(t.Status.data,function(t){return a("el-option",{key:t.Id,attrs:{label:t.text,value:t.Id}})})),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:t.getPurchaseOrderView}},[t._v("搜索")]),t._v(" "),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:t.addPurchaseOrder}},[t._v("添加采购单")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.table},on:{"selection-change":t.selsChange}},[a("el-table-column",{staticStyle:{width:"5%"},attrs:{type:"selection"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"30%"},attrs:{prop:"Id",label:"采购编号"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"15%"},attrs:{prop:"PurchaseType.Description",label:"采购类型"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"30%"},attrs:{prop:"Supplier.Name",label:"供应商"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"PaymentType.Name",label:"付款方案"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"CreateUser.UserName",label:"申请人"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"CreateDate",label:"操作时间"}}),t._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"}},[a("span",{on:{click:function(a){t.addPurchaseOrderDetail(e.row)}}},[t._v(" 明细 ")]),t._v(" "),a("span",{on:{click:function(a){t.purchaseApply(e.row)}}},[t._v(" 提交 ")])])]}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.PageIndex,"page-sizes":[5,10,20,100],"page-size":t.Pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.TotalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(r,n,!1,function(t){a("zVl+")},null,null);e.default=l.exports},"zVl+":function(t,e){}});